[
  {
    "name": "Referent can read client",
    "description": "Required when referent wants to create a file",
    "target": "subject.role.name == 'REFERENT' && action == 'READ_CLIENT'",
    "condition": "true"
  },
  {
    "name": "Referent can read or update his activity files",
    "target": "subject.role.name == 'REFERENT' && {'READ_FILE', 'UPDATE_FILE'}.contains(action)",
    "condition": "resource.baseActivity.id == subject.activity.id || resource.fileActivities.?[activity.id == #root.subject.activity.id].size() != 0"
  },
  {
    "name": "Referent can update only manage his activity",
    "target": "subject.role.name == 'REFERENT' && {'READ_FILE_ACTIVITY', 'UPDATE_FILE_ACTIVITY', 'DELETE_FILE_ACTIVITY', 'CREATE_FILE_ACTIVITY'}.contains(action)",
    "condition": "resource.activity.id == subject.activity.id"
  },
  {
    "name": "Referent can manage his activity",
    "target": "subject.role.name == 'REFERENT' && {'CREATE_ACTIVITY', 'UPDATE_ACTIVITY', 'DELETE_ACTIVITY'}.contains(action)",
    "condition": "resource.activity.id == subject.activity.id"
  },
  {
    "name": "Referent can create File with his base activity",
    "target": "subject.role.name == 'REFERENT' && action == 'CREATE_FILE'",
    "condition": "resource.baseActivity.id == subject.activity.id"
  }
]
